"use strict";var COLORS={11:"#e8e6f2",12:"#b5d3e7",13:"#4fadd0",21:"#e5b4d9",22:"#b8b3d8",23:"#3983bb",31:"#de4fa6",32:"#b03598",33:"#2a1a8a"},YEARS=["2012","2013","2014","2015","2016"],cssNamespace="cor-viz-rents",initialHilight=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Wolfsburg";e.ready().then(function(){var n=e.data().find(function(e){return e.name===t});e.hilight(n),e.control().trigger(riot.EVT.updateSelector,n),e.control().trigger(riot.EVT.updateInfobox,n)})};window.renderRentMap=function(e){var t=d3.playbooks.choroplethMap({width:600,height:810,elementId:cssNamespace+"__map--"+e,cssNamespace:cssNamespace,dataUrl:"./data/map_data.csv",geoDataUrl:"./data/landkreise_simplify200.topo.json",isTopojson:!0,topojsonLayerName:"landkreise_simplify200",responsiveSvg:!0,getId:function(e){return e.properties.RS},color:function(e){return COLORS[e]}}).render().selector({element:"#"+cssNamespace+"__selector--"+e,getLabel:function(e){return e.name}}).infobox({element:"#"+cssNamespace+"__infobox--"+e,template:"\n        <dl>\n          <dt>{rent_median} € / m²</dt>\n          <dd>Miete 2016</dd>\n          <dt>{percent_change} %</dt>\n          <dd>Anstieg seit 2012</dd>\n        </dl>\n      "}),n=cssNamespace+"__timeline--"+e;d3.playbooks.timeLineChart.defaults({elementId:n,cssNamespace:cssNamespace+"-timeline",width:150,height:200,curve:d3.curveStep,timeFormat:"%Y",yExtent:[3.5,15],getYAxis:function(e){var t=e.yScale;return d3.axisRight(t)},showXLabel:!1,showYLabel:!1,yTickFormat:function(e){return e>3?e+" €":""},yLabel:"€ / m²",yTicks:3,xTicks:3,margin:{top:20,right:15,bottom:20,left:15}});var r=(d3.select("."+cssNamespace+"__infobox-wrapper"),d3.select("#"+n)),a=function(e){r.selectAll("*").remove();var t=[YEARS,YEARS.map(function(t){return Number(e[t])})];d3.playbooks.timeLineChart({data:t,color:COLORS[e.value]}).render()};t.control().on(riot.EVT.updateInfobox,function(e){return a(e)}),initialHilight(t)},window.renderScatter=function(e){var t=d3.playbooks.scatterChart({cssNamespace:cssNamespace,elementId:cssNamespace+"__scatter--"+e,dataUrl:"./data/scatter.csv",xCol:"rent_median",yLabel:"Einwohner pro m²",xLabel:"Mittlerer Mietpreis in € pro m²",yCol:"density",getXDomain:function(){return[4,16]},sizeCol:"size",sizeRange:[4,20],groupCol:"color",color:COLORS,yTicks:5,yTickFormat:function(e){return e>0?e/1e3+" T.":""},getLegendItems:function(e){var t=e.data,n=d3.extent(t,function(e){return Number(e["2016pop"])}),r=d3.scaleLinear().domain(n).range([4,20]);return[1e5,5e5,2e6].reverse().map(function(e){var t=r(e),n=e<1e6?e/1e3+" T.":e/1e6+" Mio.";return{color:COLORS[11],label:n,size:30,radius:t}})}}).render().selector({element:"#"+cssNamespace+"__selector--"+e,getLabel:function(e){return e.name}}).infobox({element:"#"+cssNamespace+"__infobox--"+e,template:"\n        <dl>\n          <dt>{rent_median} € / m²</dt>\n          <dd>Miete 2016</dd>\n          <dt>{percent_change} %</dt>\n          <dd>Anstieg seit 2012</dd>\n        </dl>\n      "}).legend({element:"#"+cssNamespace+"__legend--"+e,wrapperTemplate:'<div class="cor-viz-rents__scatter-legend-list">{body}</div>',itemTemplate:'\n        <div class="cor-viz-rents__scatter-legend-item">\n          <svg width="{size}" height="{size}">\n            <circle r={radius} cx=15 cy=15 style="fill:{color}"></circle>\n          </svg>\n          <span>{label}</span>\n        </div>\n      '});initialHilight(t)},window.renderComparison=function(e){d3.playbooks.multiTimeLineChart.defaults({cssNamespace:cssNamespace+"-comparison",width:250,height:300,xTicks:3,yTickFormat:function(e){return e>0?e+" €":""},yLabel:"Mittlerer Mietpreis pro m²",timeFormat:"%Y",showXLabel:!1,curve:d3.curveStep,getYDomain:function(){return[0,15]},dataUrl:"./data/comparison.csv"}),d3.playbooks.multiTimeLineChart({elementId:cssNamespace+"__comparison-ruhr--"+e,yCols:["Herne","Oberhausen","Essen","Gelsenkirchen","Duisburg","Bochum","Dortmund"],color:COLORS[21]}).render(),d3.playbooks.multiTimeLineChart({elementId:cssNamespace+"__comparison-muc--"+e,yCols:["München","Dachau","Ebersberg","Fürstenfeldbruck","München (Kreis)","Starnberg"],color:COLORS[23]}).render()};
